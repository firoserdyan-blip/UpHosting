<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Menonton di UpHosting</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* General Body & Typography */
        body { 
            font-family: 'Poppins', sans-serif; 
            text-align: center; 
            padding: 20px; 
            background-color: #f8f9fa; 
            color: #343a40; 
            line-height: 1.6;
        }
        .container { 
            max-width: 800px; 
            margin: 40px auto; 
            background-color: white; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08); 
        }
        h1 { 
            color: #2c3e50; 
            font-weight: 700;
            margin-bottom: 30px;
        }
        .media-container { 
            margin-top: 20px; 
            border-radius: 8px; 
            overflow: hidden; 
        }
        
        /* Media Display Container (Wrapper) */
        #mediaDisplay { 
            width: 100%; 
            background-color: #000; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 18px;
        }
        
        /* ðŸŒŸ CSS BARU: Container Responsif untuk mempertahankan rasio (16:9 Landscape default) */
        .media-responsive {
            position: relative;
            padding-bottom: 56.25%; /* Rasio 16:9 (Tinggi adalah 56.25% dari lebar) */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            margin: auto; /* Memastikan div bisa di-pusatkan */
            border-radius: 8px;
        }

        /* Memastikan iframe, video, atau image mengisi container responsive */
        .media-responsive iframe, 
        .media-responsive video, 
        .media-responsive img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain; /* Penting untuk gambar agar tidak terpotong */
        }
        
        /* ðŸŒŸ KODE BARU: Penyesuaian khusus untuk Portrait (9:16) */
        .media-responsive.is-portrait {
            padding-bottom: 177.77%; /* Rasio 9:16 (Tinggi adalah 177.77% dari lebar) */
            max-width: 400px; /* Batasi lebar portrait agar tidak terlalu besar di desktop */
        }

        #status {
            color: #007bff; 
            font-weight: 600;
            margin-bottom: 20px;
        }

        /* Description Section */
        .description-section { 
            margin-top: 40px; 
            padding: 25px; 
            border-top: 2px solid #e9ecef; 
            text-align: left; 
            color: #495057; 
            font-size: 15px;
        }
        .description-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Menonton di UpHosting</h1>
        
        <div class="media-container">
            <p id="status">Memuat konten...</p>
            
            <div id="mediaDisplay">
                </div>
        </div>
        
        <div class="description-section">
            <h3>Tentang UpHosting</h3>
            <p>UpHosting adalah solusi hosting media online Anda yang cepat dan mudah. Kami memungkinkan Anda berbagi video dan foto dengan link yang rapi dan profesional. Cukup unggah konten Anda ke platform terkemuka, dapatkan URL publiknya, dan UpHosting akan menyajikan link pendek yang bisa Anda sebarkan ke siapa saja.</p>
            <p>Fokus kami adalah pada kesederhanaan dan aksesibilitas, memastikan media Anda dapat diakses dengan mudah dan cepat oleh audiens Anda di seluruh dunia. Mulai berbagi momen berharga Anda sekarang juga!</p>
        </div>
    </div>

    <script>
        // 1. Dapatkan ID terenkripsi dari URL
        const urlParams = new URLSearchParams(window.location.search);
        const encodedUrl = urlParams.get('id');
        const statusElement = document.getElementById('status');
        const mediaDisplay = document.getElementById('mediaDisplay');

        // ðŸŒŸ FUNGSI BARU: Fungsi untuk membungkus media dengan container responsive
        function wrapMedia(content, isPortrait = false) {
            const portraitClass = isPortrait ? ' is-portrait' : '';
            return `
                <div class="media-responsive${portraitClass}">
                    ${content}
                </div>
            `;
        }


        if (encodedUrl) {
            try {
                // 2. Dekode ID kembali ke URL Asli
                const mediaUrl = atob(encodedUrl.replace(/_/g, '/').replace(/-/g, '+'));
                statusElement.textContent = `Memuat media Anda...`;

                // 3. Tentukan Tipe Konten dan cek parameter rasio
                const isVimeo = mediaUrl.includes('vimeo.com/video/');
                const isYouTube = mediaUrl.includes('youtube.com') || mediaUrl.includes('youtu.be');
                const isImage = mediaUrl.endsWith('.jpg') || mediaUrl.endsWith('.jpeg') || mediaUrl.endsWith('.png') || mediaUrl.endsWith('.gif') || mediaUrl.endsWith('.webp');
                const isDirectVideo = mediaUrl.endsWith('.mp4') || mediaUrl.endsWith('.mov') || mediaUrl.endsWith('.webm');
                const isPortraitMode = mediaUrl.toLowerCase().includes('ratio=portrait') || mediaUrl.toLowerCase().includes('rasio=portrait');
                
                let mediaContent = '';
                let embedUrl = mediaUrl;

                if (isVimeo || isYouTube) {
                    // Penanganan YouTube & Vimeo
                    if (isYouTube) {
                        // ... (Logika penanganan YouTube)
                        if (mediaUrl.includes('youtube.com/watch?v=')) {
                            const videoId = mediaUrl.split('v=')[1].split('&')[0];
                            embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                        } else if (mediaUrl.includes('youtu.be/')) {
                             const videoId = mediaUrl.split('youtu.be/')[1].split('?')[0];
                             embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                        }
                    } else if (isVimeo) {
                         embedUrl = mediaUrl.includes('?') ? mediaUrl + '&autoplay=1' : mediaUrl + '?autoplay=1';
                    }

                    // Tampilkan Iframe/Video Player
                    mediaContent = `
                        <iframe 
                            src="${embedUrl}" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    `;
                    // Terapkan container 16:9 atau Portrait jika ada parameter
                    mediaDisplay.innerHTML = wrapMedia(mediaContent, isPortraitMode);


                } else if (isDirectVideo) {
                    // Penanganan File Video Langsung (.mp4, .mov, dll.)
                    statusElement.textContent = 'Menampilkan Video...';
                    mediaContent = `<video controls autoplay><source src="${mediaUrl}"></video>`;
                    mediaDisplay.innerHTML = wrapMedia(mediaContent, isPortraitMode);

                } else if (isImage) {
                    // Penanganan Gambar
                    statusElement.textContent = 'Menampilkan Foto...';
                    mediaContent = `<img src="${mediaUrl}" alt="Media UpHosting">`;
                    
                    // Untuk Gambar: Terapkan wrapper jika itu portrait, jika tidak, biarkan default
                    mediaDisplay.innerHTML = wrapMedia(mediaContent, isPortraitMode); 

                } else {
                    statusElement.textContent = 'Gagal: Tipe media tidak didukung atau link tidak valid.';
                    mediaDisplay.innerHTML = '<p style="color: red;">Link tontonan tidak valid.</p>';
                }

            } catch (e) {
                statusElement.textContent = 'Gagal: Link tidak valid atau tidak dapat didekode.';
                mediaDisplay.innerHTML = '<p style="color: red;">Link tontonan tidak valid.</p>';
            }
        } else {
            statusElement.textContent = 'Gagal: Tidak ada ID media ditemukan.';
        }
    </script>
</body>
</html>
